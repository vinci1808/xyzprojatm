ENTER=PROCESS; PF3=EXIT; PF5=FIRST; PF6=LAST; PF7=PREV; PRF8=NEXT
=================================================================
WORKING-STORAGE SECTION.
01  WS-CA.
    03  WS-PROCESS-FLAG		PIC X(1) VALUE SPACES.
    03  WS-EMP-?ID		PIC X(05) VALUE SPACES.
LINKAGE SECTINO.
01  DFHCOMMAREA			PIC X(06).
PROCEDURE DIVISION.
MAIN-PARA.
    IF EIBCALEN = ZERO
	PERFORM FIRST-PARA
    ELSE
	MOVE DFHCOMMAREA TO WS-CA
	PERFORM NEXT-PARA
    END-IF.
END-PARA.
    RETURN WITH TRANSID COMMAREA (WS-CA)
FIRST-PARA.
    PERFORM SEND-FIRST-MAP.
NEXT-PARA.
    EVALUATE EIBAID
	WHEN DFHPF3
	   SEND TEXT(WS-END-MSG)
	   RETURN
	WHEN DFHPF5
	   PERFORM FIRST-REC-PARA
	WHEN DFHPF6
	   PERFORM LAST-REC-PARA
	WHEN DFHPF7
	   PERFORM PREV-REC-PARA
	WHEN DFHPF8
	   PERFORM NEXT-REC-PARA
	WHEN DFHENTER
	   PERFORM PROCESS-PARA
	WHEN OTHER
	   MOVE 'INVALID KEY PRESSED' TO MSGO
    END-EVALUATE.
    PERFORM SEND-MAP.
PROCESS-PARA.
    PERFORM RECEIVE-MAP
    IF EMPIDL = ZERO OR EMPIDI = SPACES
	MOVE 'PLEASE ENTER VALID EMP ID'
    ELSE
	PERFORM READ-EMPLOYEE
    END-IF.
READ-EMPLOYEE
    MOVE EMPIDI TO WS-EMP-ID
    READ FILE('P10AFILE') RIDFLD(WS-EMP-ID)
	INTO(EMPLOYEE-RECORD) RESP(WS-RESP-CODE)
    IF WS-RESP-CODE = NORMAL
	PERFORM MOVE-PARA
	MOVE 'EMPLOYEE DETAILS' TO MSGO
    ELSE
    IF WS-RESP-CODE = NOTFND
	MOVE SPACES to Symbolic Map Variables
	MOVE 'INVALID EMP ID' TO MSGO
    ELSE
	MOVE 'ERROR READING FILE' TO MSGO.
MOVE-PARA.
    MOVE Employee Details to Symbolic Map Variables
FIRST-REC-PARA.
    MOVE LOW-VALUES TO WS-EMP-ID.
    PERFORM STARTBR-PARA
    IF WS-RESP-NORMAL 
	PERFORM READNEXT-PARA
	PERFORM MOVE-PARA
    	PERFORM ENDBR-PARA
    END-IF.
STARTBR-PARA.
    STARTBR FILE('P10AFILE') RIDFLD(WS-EMP-ID)
	RESP(WS-RESP-CODE)
ENDBR-PARA.
    ENDBR FILE('P10AFILE')
READNEXT-PARA.
    READNEXT FILE('P10AFILE') RIDFLD(WS-EMP-ID)
	INTO(EMPLOYEE-RECORD)
READPREV-PARA.
    READPREV FILE('P10AFILE') RIDFLD(WS-EMP-ID)
	INTO(EMPLOYEE-RECORD)
LAST-REC-PARA.
    MOVE HIGH-VALUES TO WS-EMP-ID.
    PERFORM STARTBR-PARA
    IF WS-RESP-NORMAL 
	PERFORM READPREV-PARA
	PERFORM MOVE-PARA
    	PERFORM ENDBR-PARA
    END-IF.
NEXT-REC-PARA.
    PERFORM STARTBR-PARA
    IF WS-RESP-NORMAL 
	PERFORM READNEXT-PARA 2 TIMES
	PERFORM MOVE-PARA
    	PERFORM ENDBR-PARA
    END-IF.
PREV-REC-PARA.
    PERFORM STARTBR-PARA
    IF WS-RESP-NORMAL 
	PERFORM READPREV-PARA 2 TIMES
	PERFORM MOVE-PARA
    	PERFORM ENDBR-PARA
    END-IF.
===================================================================


